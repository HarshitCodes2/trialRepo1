I have partially fixed some error.